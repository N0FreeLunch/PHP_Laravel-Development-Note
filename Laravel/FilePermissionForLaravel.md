# php엔지니어가 알아야 할 리눅스의 기초

## 파일 권한

리눅스의 파일에 대한 권한은, 읽기(r), 쓰기(w), 실행(x) 3가지의 권한으로 나뉘어 있다.

### 읽기 (r)

파일의 데이터를 읽을 수 있는 권한이다. 파일에 담겨 있는 이진 데이터를 바이트 단위로 취득하기 위해 사용한다.

### 쓰기 (w)

파일에 담긴 데이터를 추가, 변경, 삭제하기 위한 권한이다.

### 실행 (x)

파일에 담긴 데이터를 프로그램으로 실행을 하기 위한 권한이다.

## 폴더 권한

### 읽기 (r)

폴더 내의 파일 및 폴더 이름이나 메타 정보를 확인할 수 있는 권한이다.

터미널에서 `ls`라는 명령어로 폴더 안의 파일 및 폴더의 리스트를 확인하는 명령어가 일기 권한의 영향을 받는다.

### 쓰기 (w)

폴더 내의 파일을 생성하거나 삭제하며, 파일 이름을 변경할 수 있는 권한이다. 읽기 권한이 없다면 파일 내부에 어떤 파일이 있는지 확인할 수 없지만, 파일 경로를 지정해서 생성, 삭제, 이름 변경을 할 수 있다.

터미널에서 `mv` 명령어로 파일을 옮기거나 `rm` 명령어로 파일을 삭제하거나  `touch` 명령어로 빈 파일을 생성하는 명령어가 쓰기 권한의 영향을 받는다.

### 실행 (x)

폴더에 엑세스하는 권한이다. 파일을 프로그램으로 실행하는 권한에 영향을 주지는 않는다.

`cd` 라는 명령어로 폴더 안으로 접근하는 명령어가 실행 권한의 영향을 받는다.

## 유저 및 소유자

리눅스에는 루트(root), 시스템(System), 일반(Regular), 유령(Pseudo)의 사용자 유형이 존재한다. 컴퓨터를 켰을 때 로그인 화면의 유저는 일반 사용자 유형에 해당한다.

### 루트 사용자

### 시스템 사용자

### 일반 사용자

### 유령 사용자

## PHP의 권한
- php를 실행하는 환경이 리눅스라고 가정하고 리눅스 환경에 한해서 설명하기로 한다.

## 파일 및 폴더 권한이 중요한 이유
- 해커가 파일 인젝션을 시도 했을 때, 업로드 된 파일에 많은 권한이 부여된다면 코드 인젝션을 시도하여 원하는 코드를 실행하게 된다면 각종 해킹을 허용하게 된다.
- 코드인젝션은 시큐어 코딩으로 막고, 파일 업로드는 서버에 저장하지 않도록 클라우드 스토리지로 스트리밍으로 전송하는 방식을 사용하면 된다.
- 문제는 이러한 설정을 일괄적으로 할 수 있는 것이 아니라 코딩하면서 지속적으로 염두해서 시큐어 코드를 짜야 하는 문제가 있다. 개인의 시큐어 코딩에 대한 지식이 있어야 하며 어딘가에는 빈 틈이 발생할 수 밖에 없는 문제점이 있다.
- 코드인젝션에도 여러가지 방식이 있지만 여기서는 파일 인젝션의 경우에 방어하기 위한 파일 및 폴더 권한 설정에 관해 살펴 볼 것이다.
- 파일과 폴더의 권한을 설정하는 것은 파일 인젝션이 이뤄졌을 때 실행할 수 없도록 만드는 방식이다.

## 파일 및 폴더 권한에 대한 이해
- 파일 및 폴더 권한은 소유권한과 지정한 소유자가 파일을 어느정도 조작이 가능한지 설정하는 권한으로 나뉜다.
- 파일 및 폴더 권한은 파일의 소유자 지정, 파일의 소유 그룹 지정, 모든 유저에게 부여할 권한으로 나눠진다.
- 파일 및 폴더에 지정할 소유 그룹은 소유자를 포함하지 않는 별개의 소유그룹 지정도 가능하다.
- 각각의 소유권에 대해 파일을 읽을 수 있는 권한, 파일 쓰기를 할 수 있는 권한, 파일을 실행할 수 있는 권한으로 나뉘어 진다.
- 실행 권한은 2진법으로 표기할 때 읽기 권한을 001, 쓰기 권한을 010, 실행 권한을 100으로 부여한다.
- 각 소유권에 대한 권한을 수로 표기할 때는 각 권한의 2진법 표기 방식을 and 연산을 하여 십진법의 값으로 표현한다. 

## 파일 및 폴더 권한 777이 위험한 이유
- 777에서 7이란 파일의 읽기, 쓰기, 실행 권한을 부여한 것이다. 그리고 첫 번째 7은 소유자에게 부여한 권한 레벨, 두 번째 7은 소유자 그룹에게 부여한 권한 레벨, 세 번째 7은 그 외 모든 유저에게 부여한 권한 레벨을 의미한다.


## Reference
- https://stackoverflow.com/questions/30639174/how-to-set-up-file-permissions-for-laravel

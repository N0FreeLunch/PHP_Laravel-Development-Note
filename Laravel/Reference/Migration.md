## 마이그레이션이란?
- 마이그레이션은 데이터베이스의 버전관리 기능이라고 할 수 있다. 물론 마이그레이션의 스키마 생성, 변경, 삭제에 따라 테이블 내의 데이터가 지워질 수 있어서 완전한 버전관리 기능이라고는 할 수 없지만, 스키마 관리의 측면에서는 버전관리 기능을 한다.
- 데이터베이스에 직접 명령을 날리는 방식 및 데이터베이스 관리 툴 (MySql Workbench, Daragrip, DBeaver, SQL develop)등을 사용하지 않고 백앤드 프레임워크나 라이브러리의 마이그레이션 기능을 사용해서 디비의 스키마나 데이터를 추가, 제거, 변경을 하기 위한 방법


## 왜 마이그레이션을 사용해야 할까?
- 마이그레이션은 로컬, 개발 서버, 프로덕션 서버에서 로컬에서 설정한 데이터베이스의 스키마와, 데이터베이스에 있어야 할 기본 값을 유지시켜 줘야 할 필요성이 있다. 로컬에서 변경된 사항을 서버에 반영할 때, 직접 쿼리를 날리는 방식을 사용하거나 데이터베이스 관리 툴을 사용해서 변경을 한다면 로컬과 서버의 데이터베이스의 불일치가 발생하거나 명령어 사용 및 툴 조작의 실수로 데이터를 날려먹는 일이 생길 수 있다. 
- 이런 문제점을 방지하기 위해서 마이그레이션을 사용해서 로컬에서 충분히 태스트한 마이그레이션을 준비하고 개발 서버에서 마이그레이션을 통해 적용을 하고 문제가 있다면 로컬에서 다시 마이그레이션을 개선하고 개발 서버를 롤백하고 로컬의 마이그레이션을 적용하여 로컬과 개발의 데이터베이스 변경 사항이 서버 적용에 문제가 없는 것을 확인한 후 프로덕션 서버에 적용을 하는 방식으로 로컬과 서버 간의 스키마 및 디폴트 데이터를 일치시켜 준다.

## 라라벨 프로젝트를 처음 설치할 때
- 디폴트 마이그레이션이 존재하기 때문에 마이그레이션 명령어를 통해서 초기 테이블을 만들어 준다.
```
php artisan migrate
```

## 마이그레이션 파일 생성하기
```
php artisan make:migration create_users_table
```
- 생성한 마이그레이션 파일은 `database/migrations` 경로에 만들어진다.

### 마이그레이션 명령어 옵션
#### 코드 보일러 플레이트
```
php artisan make:migration create_users_table --create=users

php artisan make:migration add_votes_to_users_table --table=users
```
- `--create=users` 옵션은 마이그레이션 파일 안에 테이블 생성을 위한 보일러플레이트 코드를 만들어 준다.
- `--table=users` 옵션은 마이그레이션 파일 안에 테이블 생성을 위한 보일러플레이트 코드를 만들어 준다.

#### 생성 경로 지정하기
- 경로 옵션을 지정하지 않으면 기본적으로는 `database/migrations` 폴더에 마이그레이션 파일이 생성된다.
- `--path='경로'`

### 마이그레이션 파일을 하나로 합치기
- 마이그레이션을 하나의 파일로 합칠 수 있는 기능
- 마이그레이션 파일이 수백개로 늘어날 경우 개발을 편하게 하기 위해서 마이그레이션 파일을 하나로 합치는 스쿼싱 기능을 사용할 수 있다.
- 스쿼싱이란? 여러 파일을 단일 파일로 만드는 작업

```
php artisan schema:dump
```
- 스쿼싱을 실행하는 명령어

```
// Dump the current database schema and prune all existing migrations...
php artisan schema:dump --prune
```
- 라라벨은 스키마 파일의 SQL을 먼저 실행

### 스쿼싱 마이그레이션
```

```
- 라라벨의 마이그레이션이 실행되고 있지 않은 경우, 스키마의 마이그레이션이 실행된다.





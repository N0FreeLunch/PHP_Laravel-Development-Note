# Facades

## 파사드란 무엇인가?
### 서비스 컨테이너
- 라라벨에서 서비스 컨테이너는 의존성을 제공하는 도구이다. IOC 제어의 역전을 구성하기 위해서 라라벨 어플리케이션이 의존성 주입을 자동으로 집어 넣게 하기 위한 도구이다.
- 파사드에서 사용하는 서비스 컨테이너의 역할은 자동으로 의존성 주입을 하는 방식이 아니라, 서비스 컨테이너에 등록한 클래스를 정적 클래스 형식으로 쓰기 위한 도구이다.
- 그래서 서비스 컨테이너에 등록된 클래스가 객체 형식이 되어야 제대로 동작되는 것이라면 파사드로 사용하기에는 부적합하다.
- 의존성 주입을 하기 위해서는 부트스트래핑 과정 다음의 어플리케이션 전역에서 사용할 수 있는 대상이다.

### 파사드
- 서비스 컨테이너에서 사용가능한 클래스들에 대한 정적 인터페이스를 제공하는 라라벨의 기능들이라고 할 수 있다.
- 일반적으로 파사드를 사용할 때는 서비스 컨테이너에서 직접 가져다 쓰는 방식이 아니라 파사드라는 중간 매개체를 통해서 서비스 컨테이너의 대상을 불러다가 쓸 수 있다. 이 때 중간 매개체를 프록시라고 부르며 정적인 클래스를 가져다 쓴다고 해서 파사드를 정적 프록시 역할을 한다고 설명한다.

### 정적 메서드
- 정적 메서드란 객체를 선언하지 않고도 클래스의 기능을 사용할 수 있도록 구성한 것을 의미한다. 
- 보통은 클래스에 정적 멤버를 구성하기 위해서 static 이란 키워드를 사용하는데 멤버가 할당되는 곳에 메모리를 확보한다는 뜻을 가진다. 그러니 객체가 런타임에 메모리를 확보하는 것과는 달리 컴파일 타임에 메모리를 확보하는 방식이다.
- 클래스의 멤버가 특정 메모리 영역을 확보하면, 해당 멤버는 객체를 선언하든 그냥 허용하든 고정된 메모리 영역을 사용하기 때문에 공유하는 특성을 가진다.

## 파사드의 장단점
### 파사드의 장점
- 파사드는 이용하기 쉽게 간결한 문법을 제공할 수 있도록 만들어져 있다.
- 불변의 고정된 기능을 제공하므로 태스트를 용이하게 한다. 의존대상을 교체할 필요가 없으며 사용 기능은 사이드 이펙트를 만들지 않는다.
- 코드의 유연성을 유지하게 한다. 복잡한 보일러 플레이트가 필요하지 않기 때문에 코드를 변경하기 쉽다.
- 의존성 주입을 사용하면 생성자가 비대해지지만 파사드는 의존성 주입을 사용하지 않기 때문에 기능이 늘어나도 코드가 어느정도 간결하다. 
- 긴 이름의 클래스 및 네임스페이스를 사용하지 않고 쉽게 사용할 수 있는 기능을 제공한다.
- php의 다이나믹 메소드를 사용해서 태스트가 용이하다(?)

### 파사드의 단점
- 의존성 주입을 사용하면 생성자가 비대해 지는 것을 시각적으로 확인 가능하기 때문에 하나의 클래스에 많은 의존성을 집어 넣는 것을 억제하지만, 파사드는 이런 비대해지는 것에 대한 시각적 피드백이 없기 때문에 클래스에 파사드를 많이 추가하게 될 수 있다.
- 파사드는 여러 기능을 제공하는데 많은 종류의 파사드가 한 클래스 안에 있다는 것은 책임의 분산이 이뤄지지 않는 좋지 않은 코드이다.
> 따라서 파사드를 사용할 때에는, 클래스의 책임 범위를 작게 유지하도록 클래스의 사이즈를 구성하는데 특별한 주의가 필요합니다.

## 파사드 사용하기
- 모든 파사드는 Illuminate\Support\Facades에 존재한다.
- 파사드에서 제공하는 기능은 https://laravel.com/api/5.5/Illuminate/Support/Facades.html 을 통해 확인할 수 있다.
example
```
use Illuminate\Support\Facades\Cache;

Route::get('/cache', function () {
    return Cache::get('key');
});
```

## 파사드 vs 의존성 주입
### 의존성 주입
- 어떤 객체를 만들 때 이 객체가 외부의 객체를 불러다가 사용하는 경우, 생성자나 메서드의 인자를 통해서 객체를 집어넣는 경우, 객체 내에 외부 객체를 선언하는 것과는 달리 비슷한 기능을 갖는 다른 객체를 넣어서 움직이게 할 수도 있다.

### 파사드
- 파사드는 정적 클래스를 사용하는 것이며, 의존성 주입을 할 때 사용하는 유사 의존성을 제공하는 목킹(mocking) 객체나 스터브(stub : 일부 기능만을 태스트하기 위해 간략히 만든 대상)를 사용할 수 없다.
```
use Illuminate\Support\Facades\Cache;

Route::get('/cache', function () {
    return Cache::get('key');
});
```


---

## Reference
https://laravel.kr/docs/8.x/facades


described by N0FreeLunch

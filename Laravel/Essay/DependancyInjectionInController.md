### 의존성이란 무엇인가?
- 하나의 객체의 로직을 구성할 때 다른 객체의 기능이 없으면 내부 로직이 돌아가지 않는 경우 이 객체는 외부 객체에 대해 의존성이 있다고 말한다.

### 의존성 주입이란 무엇인가?
- 의존성을 외부에서 주입하는 것으로 객체 내부에 다른 객체의 기능에 의존하는 로직을 구현하는 것이다. 

### 의존성 주입을 왜 사용하는가?
- 의존성 주입은 의존성 객체를 교체할 필요가 있을 때 사용한다. 의존성을 주입할 때 클래스는 동일 클래스를 사용하거나 리스코프치환원칙이 적용되는 클래스를 대상으로 객체를 만들어 집어 넣는다.
- 의존성 주입을 사용하는 주된 이유는 모델과 같이 클래스의 캡슐화 된 특성은 그대로 유지하면서 객체의 겉으로 작동하는 인터페이스를 사용할 때 얻을 수 있는 데이터가 다양하게 변하는 경우, 변하는 데이터에 대한 다양한 양상을 태스트를 하기 위해 사용한다.
- 의존성주입은 외부 객체를 불러올 때 항상 사용하는 것이 아니라, 객체를 교체하여 뭔가 하려고 할 때 사용한다. 
- 주로 의존성은 태스트 코드를 작성할 때 주로 객체의 의존성 객체를 교체하여 태스트하는데 사용한다. 
- 좋은 프로젝트들은 태스트코드를 작성하기 때문에 의존성 주입이 가능한 코드로 작성된다.
- 그럼 태스트코드를 작성하지 않는 프로젝트라면 의존성주입 코드 없이 작성해도 괜찮을까? 의존성 주입을 사용하는 것은 객체간의 결합을 느슨하게 하는 의미도 있다. 서로 분리 가능한 객체가 되도록 만드는 것도 중요하기 때문에 의존성 주입을 사용하는 편이 좋다. 또한 추후 리펙토링을 위해서도 의존성 주입을 사용하는 편이 좋다.

### 라라벨 컨트롤러에서 사용하는 의존성
- 라라벨은 라우터에 사용할 클래스와 클래스의 사용할 메소드를 지정하면 지정한 컨트롤러 클래스의 지정한 메소드를 통해 컨트롤러 객체가 생성되고 지정한 메소드가 실행이 되는데 이 때, 라라벨의 의존성 주입을 통해 객체 생성 시에는 생성자를 통해 의존성 주입이 이뤄지며, 메소드 실행시 의존성 주입이 이뤄진다.
- 라라벨 컨트롤러에서 사용하는 의존성은 기본적으로 두 가지가 제시 되어 있다. 하나는 모델을 생성자를 통해 의존성 주입을 하는 방식이며, 또 다른 하나는 리퀘스트 객체를 메소드 주입을 통해 사용하는 방식이다. 

### 의존성을 주입하는 방법 3가지
1. 생성자 주입
2. setter 주입 (수정자 주입)
3. 메소드 주입

### 생성자 주입을 사용할 때
- 생성자 주입은 클래스의 라이프사이클 동안 주입된 객체가 바뀌지 않음을 보장하기 위한 것이다. 그래서 자바 언어에서는 재할당을 방지하기 위해 주입된 객체를 담는 변수를 final로 선언한다. 하지만 php에서는 final로 변수를 선언하고 생성자를 통해 객체를 final로 선언된 변수에 주입하는 것은 재할당 하는 것으로 여기므로 생성자를 통해 주입된 객체를 객체의 멤버에 할당할 때 final로 사용할 수 없다.
- 이 클래스를 구성할 때 필수적인 것인지 아닌지를 드러내기 위한 방식으로 사용한다. 클래스를 사용할 때 생성자를 넣지 않으면 객체를 구성할 수 없기 때문에 객체를 생성할 때 필수적인 요소로 사용된다.
- 생성자 주입을 사용하면 하나의 객체의 의존성이 어느정도인지 직관적으로 확인하기 편하다.

#### 생성자 주입의 단점
- 주입된 객체를 초기화 하는 방식이 아니기 때문에 객체의 초기화를 위해서는 메소드 주입 또는 세터 주입을 사용한다.

### 메소드 주입을 사용할 때
- 메소드별로 선택적으로 종속성을 부여해야 할 때 사용한다.
- 메소드별로 생성자를 초기화해서 사용해야 할 경우, 메소드 주입을 사용하는 것이 적절하다.

#### 메소드 주입의 단점
- 클래스의 메소드 A가 메소드 B를 실행하고 메소드 B가 A를 실행하는 경우, 순환관계를 가진다. 이 때 단순히 메소드가 서로를 참조만 하면 CPU 사용량이 늘어날 것이다. 하지만 이 메소드에 메소드 주입을 하게 되면 주입된 객체가 메모리 공간을 계속 차지하면서 터져버리는 문제가 발생한다. 그래서 일반적인 클래스의 객체지향적인 객체 사용에서는 메소드 주입보다 생성자 주입이 낫다. 순환 참조가 이뤄지지 않게 주의를 해 줘야 한다.

### setter 주입을 사용할 때
- setter 주입은 변경이 일어날 수 있다.
- 주입되는 대상을 참조 하는데 상황에 따라 객체가 달라져야 할 경우 사용하기 때문에 쓰일 일이 많이 없다.
- 주입 되는 객체의 변경이 일어날 수 있기 때문에 유의하지 않으면 치명적인 버그로 이어질 수 있다. 참조할 객체가 없거나 객체가 달라져서 메소드가 달라지는 등의 문제 뿐만 아니라 결과 등을 불어 오는 것에도 문제가 생긴다.

### 라라벨 컨트롤러에서의 의존성
- setter 주입의 경우, 사용자가 정의해서 필요한 실행 컨텍스트에 집어 넣어주는 역할을 해야 하기 때문에 개발자의 섬세한 컨트롤을 요구한다. 지능이 없는 프레임워크가 할 수 있는 일이 아니기 때문에 프레임워크는 setter 주입을 지원하지 않는다.
- 많은 예제에서 모델은 생성자를 통해 주입하고 리퀘스트 객체는 메소드를 통해 주입을 하고 있는데 그 이유는 무엇일까? 기준은 단순하다. 컨트롤러 전체의 엑션에 함께 사용되는 것에는 생성자 주입을 사용하고 엑션마다 다르게 사용되는 객체의 주입은 메소드 주입을 통해서 사용하면 된다. 
- 모델을 보통 컨트롤러의 생성자로 주입하는데 이는 CURD를 하나의 모델을 통해 사용하기 때문이다. 컨트롤러에 CURD의 엑션을 하나의 패키지로 구성하는 것은 하나의 모델에 대한 컨트롤러를 구성하기 위해서이다.
- Request 객체는 보통 파라메터를 전달 받을 때 사용한다. 파라메터의 전달을 받을 필요가 없는 경우에는 Request 객체를 굳이 사용할 필요가 없기 때문에 메소드 주입을 통해 사용한다.
- 의존성을 주입하는 것은 객체를 하나 만드는 것이다. 생성자 주입을 하면 객체는 반드시 생성되기 때문에 특정 상황에서는 쓰이지 않을 수 있는 주입 객체도 반드시 넣어야 한다. 속도적인 최적화를 위해서라면 모든 메소드에서 주로 사용하는 모델 클래스가 아니라면 메소드 주입이 나을 수도 있다. 특히 서비스 레이어의 클래스는 컨트롤러의 엑션마다 다른 것을 사용하기 때문에 메소드 주입을 보통 사용한다.




---

## Reference
- https://stackoverflow.com/questions/38998282/laravel-request-its-correct-injecting-request-directly-in-the-controller-const

# BDD?

행위 주도 개발을 의미한다. 테스트 코드를 유저의 행위에 초점을 맞춰서 만드는 것을 의미한다.

TDD가 코드를 작성하기 위한 최소한의 테스트 코드를 만드는 것에 반해, BDD는 유저의 행위로 일어날 수 있는 양상들에 대한 테스트 코드를 작성한다.

TDD를 넘어서 Unit 테스트와 통합 테스트를 작성하는 목적은, 여러 케이스에 대해 코드의 동작을 검증하고, 한 번 발생한 문제를 다시 일으키지 않게 하기 위해서 존재한다.

모든 테스트 케이스를 작성하기는 힘들다. 그래서 기본적으로는 동작하는 코드를 만드는 TDD, 그리고 유저의 행위가 일어날 수 있는 케이스에 대한 테스트만 작성 BDD, 추가적으로 유닛 테스트와 통합 테스트를 작성하는 변화로 테스트 코드를 작성하는 것이 좋다.

## 유저의 행동 테스트하기

기본적으로 테스트는 어떤 환경, 조건에서 어떤 일이 일어날지에 대한 코드를 작성하는 것이다. 이를 위해서는 환경, 조건에 대한 조건 설정을 할 수 있는 코드를 먼저 작성을 한 후, 일어날 일에 대한 코드를 검증하는 방식의 코드를 작성하는 것이 좋다.

### 라라벨에서의 테스트

라라벨은 기본적으로 유닛 테스트 보다는 feature 테스트라고 부르는 통합 테스트 기반의 테스트를 많이 사용한다. feature 테스트를 할 때는 mock을 사용하는 것이 아닌, 인메모리 데이터베이스를 이용해서 ORM이나 쿼리 빌더로 쿼리를 가져오는 로직과 애플리케이션 전체가 실행된 환경에서 테스트를 진행할 수 있다.

이 때, 데이터베이스에 데이터를 생성하는 방식으로 모델 펙토리를 만드는 방식을 사용한다. 모델 펙토리는 다양한 상태의 데이터를 만들어 내는데, 특정 테스트에서 변화될 수 있는 환경과 조건을 세팅하기 위해 캡슐화된 객체를 이용하는 것을 추천한다. 데이터베이스의 데이터를 생성할 때, 데이터를 생성하기 전에 세팅하는 것은 환경 및 조건에 대한 세팅을 할 수 있는 퍼블릭 메소드를 만들고, 생성된 데이터에 대해 이후 유저의 조작이 이뤄저서 데이터의 변경이 이뤄질 수 있는 퍼블릭 메소드를 만든다.

해당 객체를 통해서, 특정 환경과 조건에 대한 코드를 세팅하고, 어떤 유저의 행위 양상에 대한 테스트 하는 것을 하나의 테스트 단위로 정한다. 유저의 행위 양상이라는 것은, 유저가 데이터를 변화시키는 순서나 어떤 변환 값을 넣는지 등의 변화를 실제 애플리케이션에서 수행하는 것과 같은 순서와 데이터를 테스트 코드에 세팅을 하여 테스트하는 것이다.

# AI 시대의 폴더 구조

## 수평적 아키텍처

서비스, 유즈케이스, 리포지토리, DTO, ENUM 폴더를 만들고 각각의 하위 폴더에 동일 도메인의 이름을 배치한다.

## 수직적 아키텍처

도메인 별로 폴더를 만들고, 서비스, 리포지토리, DTO, ENUM 폴더를 하위에 배치한다.

## 버티컬 슬라이스 아키텍처

버티컬 슬라이스 아키텍처는 어떤 기능을 하나의 폴더 하위에 가두어 모든 작성함으로써 거의 해당 폴더만 확인하면 구현한 기능의 거의 대부분의 핵심 로직이 있기 때문에 파일 탐색이 용이하다는 장점이 있다.

그래서 사양 주도 개발을 할 때 AI 에이전트는 수직적 슬라이스 아키텍처를 추천하곤한다.

## Agents.md

AGENTS.md는 각 폴더마다 설정할 수 있는 AI 지시 파일이다. AGENTS.md에 라이브러리나 프레임워크의 각종 사용법을 압축하여 기록하여 AI의 코드 작성의 정확성과 환각을 줄일 수 있었다.

## variation

베리에이션이 큰 언어와 작은 언어가 있다. 코딩 스타일이 유사하고 큰 편차가 없는 언어가 존재하는 반면, 다양한 코딩 스타일이 가능한 언어가 있다. 전자의 경우, 고나 프레임워크를 사용하는 자바에 해당하고, 후자의 경우 자바스크립트, 타입스크립트, 파이썬, PHP, 루비 같은 언어들이다.

베리에이션이 큰 언어의 경우, AI 코딩 에이전트에게 각 프로젝트와 팀 상황에 적합한 아키테처, 코딩 스타일, 고려사항 등을 주입해야 한다. 이를 위해서는 에이전트 코딩을 위한 AGENTS.md 파일을 추가해야 하는데, 수직적 슬라이스 아키텍처의 경우, 각각의 도메인 내의 서비스, 리포지토리, DTO, ENUM 폴더에 Agents.md 파일을 배정해야 하는 수고가 있다. 그에 반해 수평적 아키텍처의 경우, 서비스, 유즈케이스, 리포지토리, DTO, ENUM 폴더 각각에 AGENTS.md 파일 하나만 세팅해 두면 되기 때문에 AGENTS.md를 통한 일관된 코드 품질을 뽑을 수 있다는 장점이 있다.

그에 반해, 베리에이션이 작은 언어의 경우, Agents.md가 없어도 일관된 품질의 코드가 작성된다는 장점이 있다. 이런 언어의 경우 AI가 좀 더 연관된 파일을 파악하기 쉬운 수직적 슬라이스 아키텍처를 사용하기가 권장된다.

## AI 시대의 수평적 아키텍처

수평적 아키텍처가 AI 주도 개발 시대에 추천되지 않는 이유는 AI 에이전트의 토큰 사용량은 제한되어 있고 AI가 파악해야 할 스코프가 적어야 좀 더 좋은 결과물이 생성될 가능성이 높아지고, AI는 분기에 의한 탐색을 잘 하지 못하기 때문에 필요한 탐색에 실패하는 경우가 자주 있기 때문이다.

이 때문에 아키텍처 레벨로 레이어를 잘 선정하여, 레이어간의 참조 순서를 정하여, 프로젝트 전역 AGENTS.md나 SKILL.md 등의 파일에 이 레이어의 참조 관계과 순서를 특정 패턴을 따르도록 하여, 서로 다른 폴더에 속한 관련 코드끼리의 탐색이 용이하도록 만드는 방식을 사용한다.

또한 각각의 파일에서 참조를 할 수 없는 파일의 경우 주석으로 참조를 할 수 있게 만드는데 php의 예를 들자면 블레이드 파일은 문자열 경로로 파일 위치를 정한다. 이는 주석에 `@see`를 지정하여 경로를 참조 시키는 방식으로 AI에게 연결된 파일을 알려주는 방법을 사용한다.

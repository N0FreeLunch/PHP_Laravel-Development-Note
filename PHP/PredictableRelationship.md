# 예측 가능한 관계

코드를 작성할 때 예측 가능한 관계성을 가지는 추상화를 하는 것이 중요하다.

## 사전 상태와 사후 상태

어떤 추상화된 코드가 실행되기 위해서는 사전에 필요한 상태가 있을 것이다. 함수 파라메터가 전달 받은 값, 동일 객체내의 멤버에 세팅된 값을 참조하는 것등 데이터베이스에서 가져온 값 등이 사전 상태가 된다. 사전 상태로 인해 추상화된 코드들이 실행되어 변경되는 변화를 사후 상태라고 할 수 있다. 함수의 반환된 값, 객체의 내부 멤버 값의 변화, 데이터 베이스나 레디스에 값의 변경과 저장 등이 사후 상태가 된다.

## 추상화

### 개념 단위의 추상화

사전 상태가 어떻게 세팅이 되면, 사후 상태는 어떻게 변화할 것이라는 것을 알 수 있도록 코드를 추상화하는 것이 중요하다. 프로그래밍에서 반복되는 코드는 추상화하라는 말을 하지만, 단순히 반복되니까 코드를 추상화한다고만 생각하는 것은 좋지않다. 반복이 된다고 추상화를 하게 되면 사용하려는 공통 코드가 생기는 특수한 맥락이 반복되는 부분에서만 사용할 수 있는 코드가 되며, 추상화 된 대상을 조합하는 로직을 만들 수 없게 된다. 복잡한 로직을 만들기 위해서는 생각할 수 있는 개념 단위들을 서로 조합해서 로직을 만들 수 있는데 단순 반복되는 코드를 줄이기 위해 추상화 된 코드는 한 단위의 개념으로 생각하기 어렵기 때문에 조합을 하기 위해 사용할 수 있는 적절한 단위가 되기 어려울 가능성이 높다.

### 사후 상태의 예측

순수 함수의 경우 어떤 파라메터에 대해 어떤 리턴 값을 가지는 것인지 알 수 있도록 추상화를 한다. 일반적인 코드는 순수함수만을 사용하기는 어렵기 때문에 사전 상태를 통해서 사후 상태의 변화를 알 수 있도록 추상화를 하는 것이 중요하다. 그래야 추상화된 코드를 가져다 썼을 때 무슨일이 일어날지 알 수 있다.

### 적절한 함수명

추상화된 코드는 사전 상태를 일관된 방식으로 사후 상태로 변경한다. 만약 특수한 케이스에 대해 다른 변환 방식을 갖는 경우 일관성에 위배되기 때문에 이런 케이스가 발생하는 추상화를 갖는 경우에는 클래스명, 함수명, 메소드명을 이런 변환을 알아챌 수 있도록 적절하게 부여주는 것이 좋다.

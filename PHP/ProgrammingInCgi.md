## CGI 환경에서의 프로그래밍

### CGI 환경이란?
- CGI는 Common Gateway Interface의 약자이다.
- 웹의 초창기에는 리퀘스트가 웹 서버로 전달 되었을 때 프로그램을 실행하여 프로그램의 실행 결과를 리스폰스로 클라이언트에 전달하는 방식을 사용하였다. 현재의 많은 언어와 프레임워크에서 채택하고 있는 애플리케이션 서버의 애플리케이션이 실행되어 하나의 프로그램이 여러 리퀘스트를 처리하는 것과 달리, 하나의 리퀘스트당 하나의 프로그램이 실행되어 리스폰스까지 생성하는 것이 CGI의 방식이다.
- 많은 php 환경에서 여전히 CGI 방식을 채택하고 있으며, CGI 방식은 리퀘스트마다 처리를 위한 프로세스를 기동해야 하므로 효율이 좋지 않음에도 불구하고 여러 편의성을 제공한다는 점에서 사용되고 있다. 이에 관해서 살펴 보도록 하자.

### CGI의 단점

#### 느린 속도
- CGI 방식이 아닌일반적인 웹 서버는 리퀘스트가 서버에 도달하기 이전에 미리 메모리에 애플리케이션을 동작시키는 코드가 이미 세팅이 되어 있는 상태이다. 그래서 리퀘스트가 도착했을 때 메모리 상의 코드 즉시 실행이 되면서 리퀘스트의 요구사항을 처리한 후 리스폰스를 반환한다. 리스폰스를 반환하고서도 애플리케이션이 종료되지 않기 때문에 다음 리퀘스트를 처리할 때도 메모리에 라이브러리와 프레임워크에서 리퀘스트 처리에 필요한 코드가 메모리에 남아 있기 때문에 빠르게 처리한다. 하지만 php의 경우 리퀘스트가 전달되었을 때 라이브러리와 프레임워크의 코드를 메모리에 올리기 때문에 처리 속도가 느리다는 단점이 있다.

### CGI의 장점

#### 메모리 관리
- 하나의 리퀘스트가 처리되고 나면 프로세스가 종료되기 때문에 메모리에 올려진 프로세스의 처리에서 사용된 코드는 모두 삭제된다. 곧, 코드의 문제로 인해 메모리 사용량이 계속 증가하는 등의 메모리 릭 문제가 발생하기 어렵다.
- 메모리 릭은 프로세스를 강제적으로 종료시키며, 웹 애플리케이션 이외의 OS를 포함한 다른 프로그램이 사용할 메모리도 잡아먹을 수 있다. 이렇게 메모리를 차지하게 되면, 서버가 다운되는 경우가 발생하는데, 서버가 다운되는 것은 애플리케이션이 에러나 예외를 처리하지 못하고 그냥 갑작스럽게 종료되어 버리는 것으로 처리 중인 작업의 손실로 인해 데이터의 무결성이 손상되는 문제가 발생할 수 있다.
- 물론 하나의 리퀘스트를 처리하는데 너무 많은 메모리를 사용해 버려서 실행되던 php 프로세스가 종료되는 경우가 발생하여 데이터의 무결성이 손상될 수 있다. 하지만, 반복적인 리퀘스트 처리를 통해서 조금씩 메모리 릭이 발생하면서 쌓이는 경우를 방지할 수 있기 때문에 상대적으로 안전하다는 특징을 가진다. 또한 하나의 리퀘스트 처리에 엄청나게 많은 메모리를 사용하는 경우도 드물기 때문에 메모리 릭의 발생 우려를 염두하지 않아도 대체로 잘 동작한다.

#### 에러처리의 생략
- php는 여러 로직이 런타임 타입힌트로 동작하기 때문에 어디선가 잘못된 타입이 전달 된 경우 에러를 발생시킨다. 한 부분에서 에러가 포착이 되지 않더라도 여러 단계를 거침에 따라 계획되지 않은 코드의 실행으로 잘못된 타입이 전달되면서 계획되지 않은 코드의 동작을 감지할 수 있는 경우가 있다. 이는 잘못된 로직이 발생시키는 문제를 발견할 가능성을 높이지만, 계획되지 않은 코드가 여러 단계의 로직을 거침에도 감지되지 않는 경우도 존재한다.
- 계획되지 않은 로직이 실행되면서 에러가 발생할 경우, 이에 대해 특별한 처리를 해 주지 않더라도 php는 프로세스의 동작을 정지시킨다. 

## 정적 언어에서 null의 의미
- 정적언어에서 `null`이란 참조의 대상이 없을 때 이를 표현하기 위한 값이다. `null`은 기본 타입의 변수에는 할당할 수 없고, 참조 타입의 변수에만 할당할 수 있는데 이는 `null`이 참조할 대상이 없음을 나타낼 때에만 사용한다는 의미를 갖고 있다. 자바를 예로 들면, 기본 타입인 int, double, boolean이 있으며 이들을 객체로 다룰 수 있는 참조 타입인 Integer, Double, Boolean 등이 존재한다. 객체로 기본 타입을 다루게 되면 값을 다룰 수 있는 다양한 메소드들을 사용할 수 있다는 편리함을 제공한다.
- 참조 타입의 값은 참조할 대상에 접근하기 위해 메모리의 특정 주소를 가리키는 값을 가진다. 그런데 지정한 포인터(주소)에서 가져올 수 있는 적절한 대상이 존재하지 않는 경우 `null` 값을 반환한다.
- `null`은 지정한 포인터 위치에 참조하는 대상이 없는 경우를 나타내기 때문에, 어떤 객체의 프로퍼티에 접근할 때 참조할 대상이 없는 null인 경우 프로퍼티가 존재하지 않아서 자바와 같은 언어에서는 null pointer exception라는 예외를 발생시킨다. 물론 nullsafe 연산자를 통해서 참조할 대상이 없을 경우를 확인하고 더 이상 값에 접근을 하지 않고 null 값을 반환하도록 할 수 있다.
- 객체는 메모리에서 생성되었다가 사라졌다가 수명을 가진 대상이다. 객체 뿐만 아니라 참조하는 대상의 상당수는 메모리에서 생성과 소멸을 한다. 이 때문에 존재하지 않는 대상을 참조하는 경우가 발생한다. 참조할 대상이 없을 때를 나타내기 위해 null 이란 값을 사용한다.

## php에서의 `null`
- php에서는 `null`이 포인터를 참조하는 방식이 아닌, 할당되지 않은 값을 나타내기 위해 사용하는 하나의 타입이자 값이다.
- php와 같이 동적 언어에서 값은 어떠한 유형의 값이라도 가능하다. 변수에 타입 제한이 있을 경우 제한된 타입의 값만 담을 수 있도록 형식적인 제약을 거는 것 뿐이다.
- php와 같은 동적 언어에서는 `?string`, `?int`, `?array` 등 `null`이란 타입과 함께 다양한 타입을 변수에 할당 가능한 유형으로 정의할 수 있다.
- 이 글에서는 참조 대상이 없다는 `null`이 아닌 하나의 타입으로서 `null`을 써야 하는 이유에 대한 글이다.

## sentinel value
- 변수의 값을 할당할 수 있는 집합에서 특정한 처리를 위해 사용되는 특별한 값을 `sentinel value`라고 부른다. 일반적으로 비할당 또는 초기값으로 센티널 값을 사용한다.
- sentinel은 보초, 감시자란 의미를 가지고 있다. 이는 sentinel value 해당하는 값은 특별한 처리를 해 줘야 하는 값이므로 변수를 처리할 때는 센티널 값인지 주의 깊게 확인하라는 의미를 가진다. 곧 감시 되어야 하는 값이란 의미이다.
- 센티널 값은 어떤 코드에서 동작하느냐에 따라 서로 다른 의미를 지닌다. 0과 양수만을 다루는 코드에서는 음수는 센티널 값이 되며, 자연수만 다루는 코드에서는 0은 센티널 값이 되며, `null` 또는 `false`를 병용하는 타입의 변수에서는 이들 값이 센티널 값이 될 수 있다. php8.2에서는 `false`도 하나의 타입으로 사용할 수 있게 되었는데 센티널 값으로 쓰기 위한 `false`를 위한 것으로 보인다.
- 정적 언어에서 센티널 값은 해당 타입이 가지는 값 중에서 가장 사용되지 않는 값을 사용하는데, 배열의 경우에는 인덱스를 나타내는 값이 -1인 경우를 센티널 값으로 지정할 수 있고, int 타입의 경우에는 int의 최대값인 2147483647이란 값을 센티널 값으로 사용한다. 물론 이는 변수를 어떤 용도로 사용하느냐에 따라 센티널 값을 다르게 정의할 수 있다. 센티널 값에 해당하는 값을 상수로 정의를 하고 변수의 값이 상수로 정의한 센티널값에 해당하는지 확인하고 할당과 비할당 등을 확인할 수 있다.
- 또한 도메인의 제약에 따라 센티널 값이 달라질 수도 있는데 엘리베이터에 탑승할 수 있는 최대 무게를 800kg라고 하면 800을 초과할 때는 엘리베이터를 움직이지 않게 하기 위해 801kg등을 센티널 값으로 만들 수도 있을 것이다. 하지만 센티널 값을 너무 임의로 지정하면 코드를 이해하는 시간이 더 걸릴 수 있으므로 보편적으로 사용되는 값을 센티널 값으로 사용하는 것을 권장한다.

#### 단일 타입에서 센티널 값
- int, float 집합에서 0은 단순 수 0인 값 뿐만 아니라 값의 비할당을 나타내는 특별한 값으로 쓰일 수 있는 센티널 값에 해당한다.
- 문자열 집합에서 `""`은 단순 빈 문자열일 뿐만 아니라 비할당을 나타내는 특별한 값으로 쓰일 수 있는 센티널 값에 해당한다.
- 배열에서 `[]`는 은 단순 빈 배열일 뿐만 아니라, 비할당을 나타내는 특별한 값으로 쓰일 수 있는 센티널 값에 해당한다.

## 동일 타입의 값의 문제
- 접근하려는 값이 동일 타입에서의 센티널 값인 경우 이 값이 실제 처리할 대상인지 그렇지 않은 구분 값인지 알 수 없다는 단점이 있다. 이 때는 해당 값이 센티널 값일 때 처리 되어야 하는지, 그렇지 않은지를 생각하는 것으로 어느 정도 판단을 내릴 수 있다. 예를 들어 수량이 0인 경우는 처리할 대상이 없다는 것이며, 가격이 0인 경우는 처리할 대상이 있다는 의미를 가진다.
- 멤버 변수의 할당과 비할당을 구분하는 것은 해당 멤버 변수를 이용하여 연산을 진행할 것인지 진행하지 않을 것인지 결정하기 위한 판단 기준이 된다. 비할당을 `null`으로 할당을 지정한 타입의 값으로 한다면 값이 `null`이 아니란 것을 통해서 멤버 값의 할당이 되었는지 되지 않았는지 알기 쉽지만, 할당을 단일 타입의 센티널 값으로 지정하게 될 경우 이 값이 할당이 된 값인지 되지 않은 값인지 알 수 없기 때문에 연산을 진행시켜야 하는지 그렇지 않은지 판단하기 애매한 경우가 생길 수 있다. 그렇다고 해서 모든 값을 `null`과 병행하는 것은 로직의 분기 처리를 늘릴 수 있기 때문에 추천하지는 않는다.
- 예를 들어 `null`을 병용하지 않는 객체는 반드시 존재하기 때문에 `->`만 써도 괜찮은데 `null`을 병용한 객체는 `?->`을 사용하는 경우가 많다. 이 경우에도 객체가 반드시 전달되는 경우가 있으므로 `->`만 써도 충분한데, `?->`을 남용하는 경우가 생긴다. `?->`는 객체가 존재하지 않을 가능성을 고려한 것인데 `obj1?->obj2?->obj3` 이렇게 계속 객체에 접근할 경우, 어디서 `null`이 반환되었는지 알기 어려운 경우가 생길 수 있다. 이런 `?->`는 편하지만, 값이 어디서 `null`이 되었는지 알기 어렵게 하는 단점이 있다. 값의 타입을 늘리는 것은 이런 모호성을 초래한다.

## `null`을 사용해야 할 경우
- 각 타입의 모든 값이 처리를 하기에 유의미한 값이기 때문에 동일 타입에서는 센티널 값을 정의하기 어려운 경우, `null`을 사용해서 값의 할당 비할당 여부를 파악할 수 있도록 한다.

## `null`할당의 단점
- 일반적으로 값이 할당되지 않은 경우라면 값의 할당을 위한 로직을 실행하거나 에러를 발생시켜 값이 할당되지 않았을 경우를 배제하는 로직을 추가 해 줘야 한다.
- 대부분의 경우, `null` 값과 함께 연산을 하게 되면 연산 과정에서 에러가 발생하기 때문에 `null` 때문에 문제가 발생했다는 것을 파악할 수 있다는 장점이 있다.

## `null`할당의 장점
- 대부분의 언어에서 `null`인지 쉽게 파악할 수 있는 문법적인 설탕이 존재한다. php8 버전 이상에서는 `type1 | type2 | type3`으로 여러개의 타입을 받을 수 있는 타입힌트가 존재한다. 이 때마다 어떤 타입과 `null` 타입을 같이 받을 수 있다는 `null | type`을 써 주는 것은 조금 귀찮다. `null | type`을 의미하는 `?type`라는 간단한 표현식. `if(property_exists($객체, 프로퍼티명)) $객체->프로퍼티명`을 `$객체?->프로퍼티명`으로 간단히 표현하는 방법, `if(is_null($변수)) $변수 = 디폴트값`을 `$변수 ?? 디폴트값`으로 간단히 표기하는 방법등을 제공한다.
- 할당과 비할당을 구분하기 위해서 `null`을 사용하는 것은 문법적인 구문까지 제공될 정도로 일반적으로 사용되는 값이다. 할당 비할당을 위해서 다른 특별한 타입을 사용할 필요가 없이 `null`으로 통일하여 어떤 타입에 추가적으로 `null`을 허용하고 있다면 할당과 비할당을 고려하라는 의미라는 것을 미리 파악하고 그에 맞게 사용할 수 있다.

## `null`값도 가진다는 불편함
- 할당의 유무를 판단하는데 있어서 `null`이 유용한 대상인 것은 맞지만, 할당이 이뤄지고 나서는 타입의 `null` 허용을 맘편히 잊고 사용하고 싶을 것이다. 이를 위해서 할당 후 연산을 할 때는 해당 값을 `getter`를 통해서 가져오는 방식을 사용하며 `getter`함수의 리턴 타입에 `null`을 제외하는 방법을 사용하여 멤버에 직접 접근하지 않는 방식의 코딩 컨벤션을 두던가, 타입힌트로 타입 제한에 `null`을 배제하기 위해 함수의 인자로 값을 전달하여 연산을 수행하도록 하는 방법 등을 생각해 볼 수 있다.

## Reference
- https://peakd.com/hive-168588/@crell/much-ado-about-null
- https://en.wikipedia.org/wiki/Sentinel_value
- https://wiki.php.net/rfc/null-false-standalone-typesx

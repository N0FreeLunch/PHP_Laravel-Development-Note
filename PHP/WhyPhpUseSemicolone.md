# php에서 세미콜론을 강제하는 이유

## 명령 단위의 종료를 구조적으로 나타내는 언어와의 차이
- 파이썬, 고 언어와 같은 언어는 개행을 통해서 명령 단위의 종료를 한다.
- 하지만 자바스크립트, php와 같은 언어는 새미콜론을 통해서 코드의 표현을 다양하게 사용할 수 있다. 한줄에 코드를 압축하는 방식, 여러 줄에 걸쳐 구분을 해서 작성하는 방식 등등
- 물론 이러한 방식이 코드 가독성에 좋은 요소는 아니기 때문에 PSR 등을 통해서 표준적인 코딩 스타일을 권장하고 있다. 하지만 필요할 때가 있다.

## 자바스크립트에 비해 새미콜론 사용이 엄격한 이유
- php는 HTML 문서에 표시할 문자를 프로그래밍 언어로 만들어 내기 위해 만들어진 언어이다.
- HTML 문서의 다양한 표현 방식에 맞게 자유롭게 코드를 배치할 필요성이 있기 때문에 하나의 구문이 끝나는 새미콜론을 반드시 강제하였다.
- 자바스크립트의 새미콜론은 명령 단위의 한 줄 표현을 가능하게 하지만, 여러 줄이 되는 경우 자동으로 명령 단위가 끊기게 된다. 새미콜론을 사용한 한 줄 표현은 자바스크립트 코드 압축화를 위해 유용하지만 새미콜론으로 코드를 늘리는 것은 코드 압축화를 위해 쓰이지 않는 측면과 문법 작성에 새미 콜론을 강제하게 되면 불편함을 초래하기 때문에 사용하지 않도록 컨셉으로 만들어진 특성으로 보인다.

## 새미콜론의 역할
- 새미콜론의 역할은 명령어 종료이다.
- https://www.php.net/manual/en/language.basic-syntax.instruction-separation.php

## 새미콜론의 활용 예

### if문의 중괄호 생략시
- if문에 {}를 사용하지 않고 사용하기 위해 타 언어의 경우 if문과 동일한 줄 또는 if문 다음 한 줄만을 사용하는 방식을 쓰지만 php에서는 if() 다음에 {}를 쓰지 않고 여러줄의 코드를 작성할 수 있다. 물론 이 여러줄은 새미콜론으로 분리되는 코드가 아니어야 한다.
```
if($this->isA())
    $this->b()
        ->c()
        ->d();
```

### php 태그를 열고 닫지 않는 경우
```
<?php echo 'Ending tag excluded';
```
- 위 코드는 동작한다. 세미콜론은 명령의 종결이기 때문에 뒤에 php 코드가 더 있을 수 있음을 암시한다.
- 하지만 파일이 끝났기 때문에 더이상 php 코드가 있을 것을 염두하지 않을 수 있다.
```
<div>
<?php echo 'Ending tag excluded';
</div>
```
- 위의 코드는 에러구문이다. html과 섞어 쓸 때는 ?>을 반드시 적어 줘야 한다. 
- 왜냐하면 세미콜론은 뒤에 php 코드가 더 있음을 염두하는데 php 태그가 닫히지 않았다면 </div>를 php 코드로 보고 해석을 해 버리기 때문에 에러가 난다.
- HTML 태그와 함께 쓰기 위해서는 ?>으로 php 태그를 닫아 줘야 한다.
- 명령의 종결과 php 태그의 종결을 구분하자.

## 새미콜론을 생략할 수 있는 특별한 경우

### 파일의 마지막 코드
- 하나의 php 파일의 마지막 코드에서는 새미콜론을 생략할 수 있다. 마지막 코드는 어차피 명령을 끝내는 것이라서 새미콜론 없이도 명령 수행이 가능한 것으로 보인다.
- https://stackoverflow.com/questions/29284075/why-is-the-semicolon-optional-in-the-last-statement-in-php/29284131

### 일급 시민이 아닌 문법 단위에서 사용가능
```
class Sample
{
    $nestedObj = new class {
    };
}
```
- 익명 클래스는 세미콜론을 요구한다. 그러나 클래스는 세미콜론을 요구하지 않는다.
- if 문이나 while 문의 중괄호를 닫을 때는 세미콜론을 요구하지 않는다.
- 클래스, if문 while 문 등은 하나의 독립적인 단위로 쓴다. 익명 클래스의 경우에는  `$nestedObj = new class {};`으로 할당하는 방식 곧 일급 시민으로 사용된다. 일급 시민의 역할을 가진다면 다른 문법들과 함께 사용했을 때 명령의 끝이 어디서 끝나는지 알려 줄 필요가 있기 때문에 종결을 나타내는 세미콜론을 요구한다.

### PHP 태그를 닫을 때
```
<?php echo "test"; ?>
```
뿐만 아니라
```
<?php echo "test" ?>
```
도 가능하다.
- 이유는 ?>가 명령의 끝을 의미하기 때문에 세미콜론을 생략할 수 있다.

## 문자열 키워드는 종결의 의미라도 세미콜론을 요구
```
if (true):
 echo "<p>Hello World !!!</p>";
endif;
```
- 위의 경우 endif는 명시적으로 if문을 닫는다는 역할을 가지고 있다. 그럼에도 불구하고 꼭 세미콜론을 강조하고 있다.
- 문자열 문법 키워드는 문법적인 종료 역할을 하지 않는다는 관점을 가지고 있어서 endif 다음에 세미콜론을 쓰게 만든 것으로 보인다.

## 세미콜론 사용의 문제
- 문제는 php에 대한 교육을 할 때 언제 세미콜론을 써야하고 언제 세미콜론을 쓰지 말아야 할지 명확하게 알려주지 않는다는 것이다.
- 초보자들의 경우 이 문법을 사용할 때는 세미콜론을 쓰지 않는구나라고 예외를 기억해야 한다. 세미콜론을 제대로 쓰지 않으면 에러가 나는 건 덤 IDE가 잡아 주지 않는다면 초반 학습 코스트가 되는 부분이다.

## 언제 PHP를 사용해야 할까?

PHP는 장점도 있지만 단점도 있는 언어이다. PHP의 장단점에 대한 상세한 소개는 본 문서의 범위를 벗어난다. 이 문서에서는 언제 PHP를 사용하면 좋은지 좋으면 왜 좋고 안 좋으면 왜 안 좋은지에 대한 설명에 초점을 맞춘다.

### 최저비용 서버 개설 가능

아주 저렴한 서버를 만들어야 할 경우가 있다. 이 때 렌탈 서버 또는 호스팅 서버라는 서버를 사용해서 php 파일을 업로드 하는 것으로 코드를 동작시킬 수 있다. 렌탈 서버는 저렴하면서 DB까지 사용할 수 있지만, 도메인 비용, SSL 비용 등의 지출이 동반되며, CLI의 사용이 제한되고, FTP등을 통한 파일 업로드를 사용해야 하기 때문에 개발에 많은 불편함이 따른다. 한 번 만들어 주고 지속적인 유지보수 비용이 발생하지 않는 간단한 프로젝트인 경우 이용할만하다.

초 저비용 서버를 만들기 위해 예전에는 PHP를 사용한 렌탈 서버 호스팅 서버를 사용했지만, 요즘에는 저 트레픽의 경우 서버리스틀 통해 사이트를 개발하는 추세이다. AWS의 Amplify, API gateway + Lambda, DynamoDB, S3를 이용하면 도메인 비용 + 아주 적은 이용당 요금을 통해서 더 저렴한 서버를 구축할 수 있고, SAM과 같은 서버리스 프레임워크를 이용해서 로컬에서 테스트도 진행할 수 있다. 트레픽이 적을 경우 PHP 호스팅 보다 더 저렴한 비용의 서버를 만들 수 있다.

하지만 여전히 서버리스를 사용한 방식 또는 PHP 호스팅/랜탈 서버를 이용한 방식의 구축 이외에는 초 저비용 스텍을 구축하기 어렵기 때문에 하나의 선택지로서 생각될 수 있다.

### NodeJS와 비교

NodeJS 계열에서 서버 개발은 Typescript를 통해 PHP보다 엄격한 타입 안정성을 갖춘 개발이 가능하다는 장점이 있지만 몇 가지 문제가 있다.

#### 라이브러리

개발시 사용한 라이브러리가 계속 폐기되는 문제로 장기적인 메인테인스 및 업데이트에 곤란을 겪는 문제가 있다.

PHP는 라라벨 심포니와 같은 오랜 세월 지속적인 업데이트과 관리를 보증하는 프레임워크가 존재하고, PHP의 문법 업데이트는 매우 보수적으로 진행되므로 오랜 세월 메인테인스하기 유리한 면이 있다.

#### ORM 라이브러리

NodeJS는 지금껏 성숙한 ORM 라이브러리/프레임워크가 없어 서버 개발에서 여러가지 성가신 경험을 해야하는 겪는 문제가 있다.

PHP는 Eloquent 나 Doctrin과 같은 오랜세월 성장한 ORM 라이브러리가 존재한다.

하지만 최근 [dizzle](https://github.com/drizzle-team/drizzle-orm)이란 좋은 ORM이 나왔으므로 더 이상 PHP가 자바스크립트 대비 ORM 생태계가 좋다고 하기 어려워졌다.

물론 각각의 ORM 라이브러리의 장단점이 있기 때문에 PHP라면 PHP 생태계의 ORM의 장점을 포기하고 무리하게 NodeJS 진영으로 옮길 필요가 없다.

#### 정수 타입 부재

자바스크립트에서는 interger 타입이 없어 금융과 관련된 도메인에서 어려움을 겪을 수 있다.

물론 양쪽 언어 모두 동적인 계산이 이뤄질 가능성이 있는 언어로 자바스크립트라면 Bigint 또는 수치 연산 관련 라이브러리를, PHP라면 BCMATH와 같은 라이브러리를 이용하는 방식을 사용해야 하므로 큰 문제는 아니다.

#### 메모리 문제

자바스크립트는 메모리를 통제할 수 없는 언어이다. 물론 PHP도 마찬가지이지만 통제할 수 있는 범위가 다르다. php는 unset을 사용해서 변수에 연결된 참조를 끊을 수 있어서 가비지 컬렉터의 메모리 자원 회수를 유도할 수 있고, 코딩 스타일도 자바스크립트 만큼 마구마구 외부 변수를 참조할 수 있는 문법은 아니다. 물론 하려면 할 수 있다. 하지만 자바스크립트는 자유로운 클로저 사용 및 참조를 끊는 것을 통제하지 못하는 코딩스타일이 많기 때문에 메모리 릭이 발생하기 쉽다.

또한 PHP는 CGI 방식이기 때문에 메모리 릭이 있어도 잘 초기화 되기 때문에 메모리로 인한 문제가 발생하는 일은 적다. 하지만 자바스크립트의 경우 하나의 프로세스로 수 많은 처리를 하기 때문에 메모리 릭이 조금씩 쌓이면서 서버가 터지는 경우가 생길 수 있다.

메모리 문제로 인해 애플리케이션이 종료되면, 프로그래밍 언어의 코드로 마련한 각종 후속처리가 이뤄지지 않고 이 때문에 요청에 대한 처리를 올바로 할 수 없는 경우가 있을 수 있다. 이는 고객이 진행하고 있는 절차를 완수할 수 없게 할 수 있게 하여 나쁜 경험을 줄 수 있고, 하나하나의 리퀘스트가 중요한 분야라면 하나의 요청을 잃는 것이 큰 손실이 될 수 있다는 문제가 있다.

### 빠른 피드백 루프가 존재하는 도메인

PHP는 타입 안정성이 부족한 언어이다. 어떤 기능을 수정했을 때 이를 사용하는 코드가 여럿 있다면 여러 기능들을 함께 동작 확인을 해 줘야 한다. 따라서 모든 기능에 테스트 코드를 작성할 필요성이 존재하며, 테스트 코드가 없다면 모든 기능을 수작업으로 새롭게 확인해야 하는 문제점이 있다. 프로덕션 서버, 개발/검증 서버, 로컬 서버 등에서 데이터의 부재로 충분히 로직의 동작을 재현할 수 없는 문제가 있는 경우가 있고, 이 때문에 수정을 했을 때 문제가 발생하기 쉬운 언어가 PHP이다. 이런 PHP의 문제를 감수하고도 사용하기를 원한다면 문제가 발생했을 때 빠른 피드백을 통한 개선이 가능하고, 어떤 문제가 발생했을 때 프로그래밍 뿐만 아니라 비즈니스 등의 협상, 교섭, 안내 등으로 어느 정도 발생한 문제를 해결 할 수 있을 때 사용하는 편이 좋다. 물론 타입 문제를 해결하기 위한 방법으로 정적 분석 및 정적 분석이 가능한 스타일로 코딩을 할 수 있는 프렉티스 도입 등을 활용할 수 있겠지만, 이런 걸 도입한다면 다른 정적 언어가 더 나을 수 있는데 굳이 PHP를 써야할까?라는 의문이 생길 수 있다.

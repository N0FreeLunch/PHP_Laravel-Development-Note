## 함수형 프로그래밍에 좋지 않은 PHP

### PHP 함수형 프로그래밍을 지원한다.
- 고차함수를 만들 수 있다.
- 클로저를 사용할 수 있다. 
- 1급 객체를 지원한다.
- 참조 투명한 객체 또는 함수를 만들 수 있다.

### 불변성에 대한 지원이 약하다.
- 상수의 지원은 CONST 키워드로 사용한다. CONST 키워드는 PHP 파일 단위에서의 전역공간 또는 PHP의 글로벌 상수 또는 클래스 내의 멤버로 선언하는 방법이 있다. 함수 스코프 내에서는 CONST 키워드를 사용할 수 없다는 단점이 있다.
- 함수 스코프 내에서 사용할 수 있는 변수는 상수로 선언 될 수 없기 때문에 변경의 위험성을 가지고 있다. 변수의 값이 일정한지 일정하지 않은지 코드 맥락에서 확인하는 것은 코드를 인지하는데 필요한 시간을 더 걸리게 하고 이는 생산성의 저하로 이어진다. 편하게 사용하기 위해 만들어진 PHP는 함수 스코프 내에서도 상수 선언을 자유롭게 할 수 있는 편이 좋지 않을까라는 생각이 든다.
- 상수를 명명할 때 항상 대문자로 표기해야 하는 관습이 있다. 상수를 일반적으로 사용하는 함수형 프로그래밍은 이 관습을 무시해야 오히려 편해진다.

### 함수형 표현을 사용하는데 보일러 플레이트가 많다.
- 자바스크립트 처럼 ```() => 'return value'``` 간단한 표기가 없다. php8에서는 ```fn() => 'return value'```방식을 지원하지만 다른 언어의 간단한 표기 보다 좀 더 많은 보일러 플레이트를 요구한다.

### 멀티코어를 활용할 수 없는 구조
- PHP는 보통 웹서버로 사용한다. 그런데 흔시 사용되는 CGI 방식의 웹 서버에서는 멀티코어의 사용을 권장하지 않는다.
- 함수형 프로그래밍은 불변성의 모듈을 쌓아가면서 프로그래밍을 하는데 불변성 모듈을 쌓아서 프로그래밍을 하는 수고에 비해 멀티코어를 활용하지 못하므로 함수형 프로그래밍을 하기 위한 보일러 플레이트가 많은 것에 비해 좋은 효과를 얻을 수 있을지 의문이 든다.
- swoole을 사용하면 코루틴과 채널을 활용한 병렬 프로그래밍을 지원한다. 하지만 swoole을 통한 병렬 프로그래밍은 함수형 표현을 상용한 병렬 연산을 활용하는 것과는 다른 방식의 구현이다. 함수형 표현을 활용하는 것이 의미 있을지 의문

### 비동기를 제대로 활용할 수 없는 구조
- PHP8에서 fiber라고 비동기 문법을 지원한다. 하지만 fiber는 사용자를 위한 문법이 아니라, 라이브러리 제작자를 위한 문법으로 고안되었다. php에서 비동기 문법을 사용하기 위해서는 reactPHP 또는 php AMP 라이브러리를 설치하여 사용하도록 권장되고 있다.
- 비동기를 활용하기 위해서는 이들 라이브러리가 제공하는 방식으로 I/O 관련 기능을 사용해야 하는데, 프레임워크를 사용하고 있다면 프레임워크의 I/O 기능이 이들 비동기 라이브러리를 지원하지 않기 때문에 코드를 섞어 쓰게 되고 이상한 코드를 만들어 내게 된다. 코드의 일관성을 위해서 프레임워크를 사용할 때는 이들 비동기 라이브러리를 사용하지 않는 편이 훨씬 낫다.

## 일관성이 없음
- 일관성이 없다는 것은 사용하는데 있어서 비슷한 구조를 가지고 있지 않기 때문에 기억해서 사용하기 어렵다는 것이고, 기억해서 사용하기 어렵다는 것은 하나 하나 사용할 때 마다 찾아 봐야 한다는 의미이다. 이는 결국 생산성의 저하로 이어지게 된다.
- 좋은 서비스를 만들기 위해서는 언어 수준에서 예측할 수 있는 코드를 짜는 것이 중요하다. 하지만, 비일관성은 언어 수준에서 파악하는데 좀 더 많은 시간이 필요한 코드를 만들어내기 때문에 해석 및 태스트에 소모되는 비용이 더 요구되는 문제가 있다. (물론 직접 태스트 코드를 짤 때는 다른 정적 언어에 좀 더 쉽게 태스트 코드를 짤 수 있다는 점이 장점이라고 할 수 있다?)
- php 내장 함수들의 비일관성 때문에 최대한 언어에서 제공하는 기능을 사용하는 것이 이득인 코딩 태스트를 할 때는 php는 경쟁력이 없을 듯

### 배열 함수의 비일관성

#### 배열 함수의 인자의 순서의 비일관성 
- callable과 array의 인자 순서가 배열 함수마다 다르다. http://phpsadness.com/sad/6
- haystack과 needle의 인자 순서가 배열 함수마다 다르다. http://phpsadness.com/sad/9

#### 배열 함수의 비일관성을 해결하기 위한 방법
- 부족한 일관성에 대한 해결 방법 : 일관성 있게 만든 매핑된 라이브러리를 사용한다. 이를 위해서는 지속적으로 메인테인스가 이뤄지는 인기 있는 라이브러리로 사용하는 것이 중요하다. 배열 함수를 사용하지 말고 라라벨 컬렉션을 제공하는 라이브러리를 사용하는 방법 등을 사용하자. 
- 라라벨 컬렉션만 분리한 라이브러리 : https://github.com/tighten/collect

### 문자열 함수의 비일관성

#### 문자열 함수 명칭의 비일관성
- 언더바 \_를 사용한 명칭과 \_를 사용하지 않은 명칭이 혼합되어 있다. http://phpsadness.com/sad/4

#### 문자열 함수의 비일관성을 해결하기 위한 방법
- 라라벨의 경우에는 문자열을 지원하는 helper 함수 `str::함수명` 기능을 사용한다.

## 표준 라이브러리에서 제공해야 할 기능을 서드파티로 떠 넘김
- 일반적으로 다른 언어는 언어와 함께 표준 라이브러리의 기능을 제공한다.
- 하지만 PHP의 경우 어느정도 기본적인 기능을 언어 차원에서 제공하지만 사용자 편의를 위한 기능을 서드파티 라이브러리에 떠맡긴다.
- 표준 내장 객체가 잘 만들어져 있어서 외부 라이브러리에 의존하는 긴능을 줄이는 것이 좋은데 내장 기능을 사용하자니 편하게 사용하기 어려운 문제점이 있고, 쉽고 편리한 기능을 제공하는 라이브러리를 쓰자니 신뢰성이 떨어지는 서드파티 라이브러리를 꼭 사용해야 하는 문제가 생긴다.
- 그리고 내장 기능은 OOP 방식으로 캡슐화 되어서 기능을 제공하고 있지 않고 요즘 추세와 맞지 않는 상대적으로 저수준(C언어 보다는 나은)의 개념으로 만들어져 있기 때문에 가독성과 기능을 알기 위해서는 설명을 해석하기 쉽지 않은 PHP 내장 기능을 이해해야 한다. (심지어 이걸 제대로 이해하고 쓰고 있는 사람이 어느정도 될지도 모를 정도) 쉽게 쉽게 어떤 기능을 활용할 수 있는지 잘 캡슐화된 대상을 표준 라이브러리에서 제공할 필요가 있다고 본다. 매커니즘에 대한 대략적인 이해만으로도 명확하게 어떤 기능을 하는지 알고 사용할 수 있도록 해야 할 것.
- 표준 라이브러리를 만들어서 미래에도 계속적으로 유효한 라이브러리를 만들어 써드파티가 아닌 표준 라이브러리의 사용을 권장하는 방식으로 코딩의 표준을 잡을 필요가 있어 보인다.
- PHP 사용자별로 라이브러리 사용자 별로 프레임워크 사용자 별로 파편화된 지식을 습득하게 되면서 일관성을 맞추기 위해서 내장 함수에 의존하게 된다. 이로 인해 OOP를 제대로 활용하지 못하는 문제가 발생한다.
- 클래스화 되어 있는 array function 기능을 통한 체이닝 지원, 기본적인 기능을 모두 포함하고 있는 curl 간편한 curl 기능, async await 등등의 기능

### 자바스크립트와의 비교
- 자바스크립트의 경우, 자바스크립트 해석 엔진과 함께 표준 내장 객체를 제공한다. 
- 자바스크립트의 표준 내장 객체는 https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects 에서 확인 가능하다.
- 또한 노드 JS와 브라우저는 각각 내장 라이브러리를 제공한다. 노드 JS의 내장 라이브러리 또한 기능이 너무 많고 쉽게 사용하기 쉽지 않다. 하지만 브라우저의 내장 라이브러리는 사용하기 쉽고 이해하기 쉽도록 만들어져 있다는 것이 느껴진다.


## Reference
- http://phpsadness.com/
 
